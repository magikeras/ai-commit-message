<idea-plugin>
    <id>com.aicommitmessage</id>
    <name>AI Commit Message</name>
    <vendor email="magikeras@gmail.com" url="https://github.com/magikeras">magikeras</vendor>

    <description><![CDATA[
    Generate commit messages in Conventional Commits format using Anthropic Claude AI.

    <h3>Features</h3>
    <ul>
        <li>One-click commit message generation from staged changes</li>
        <li>Conventional Commits format out of the box</li>
        <li>Powered by Anthropic Claude (Sonnet, Haiku, Opus)</li>
        <li>Multi-language support (English, Russian)</li>
        <li>Customizable prompts</li>
    </ul>

    <h3>Usage</h3>
    <ol>
        <li>Configure your Anthropic API key in Settings → Tools → AI Commit Message</li>
        <li>Stage your changes in Git</li>
        <li>Open the Commit dialog</li>
        <li>Click the ⚡ "Generate Commit Message" button in the commit toolbar</li>
    </ol>

    <h3>Requirements</h3>
    <ul>
        <li>Anthropic API key (get one at <a href="https://console.anthropic.com/">console.anthropic.com</a>)</li>
        <li>Git integration enabled in your IDE</li>
    </ul>
    ]]></description>

    <change-notes><![CDATA[
    <h3>1.2.5</h3>
    <ul>
        <li>Changelog now visible on JetBrains Marketplace</li>
    </ul>
    <h3>1.2.3</h3>
    <ul>
        <li><b>Skip tags:</b> append [#skip-ci] / [#skip-test] to commit subject — with ask-each-time popup or default toggle</li>
        <li><b>Message depth:</b> short (subject only), medium (subject + brief body), detailed (subject + bullet points)</li>
        <li><b>Unversioned files:</b> checked files from "Unversioned Files" section are now included in diff analysis</li>
        <li><b>No selection handling:</b> shows "no selected changes" in commit field instead of popup dialog</li>
        <li><b>Auto-open settings:</b> opens plugin settings directly when API key is missing</li>
        <li><b>Expert prompt:</b> new built-in prompt focused on specific, actionable commit subjects</li>
        <li><b>Settings override:</b> depth, skip tag, and locale always apply on top of custom prompt</li>
        <li>Fix: skip tags now correctly use # symbol ([#skip-ci], [#skip-test])</li>
        <li>Fix: ActionUpdateThread deprecation warning</li>
    </ul>
    <h3>1.2.0</h3>
    <ul>
        <li>Correctly get checked files from commit dialog via CheckinProjectPanel</li>
        <li>Fix button always disabled in commit toolbar</li>
    </ul>
    <h3>1.1.0</h3>
    <ul>
        <li>Generate from checked files only (not all changes)</li>
        <li>Show "(generating commit message...)" placeholder during API call</li>
        <li>Silent background generation without progress bar</li>
    </ul>
    <h3>1.0.2</h3>
    <ul>
        <li>Remove untilBuild limit — compatible with all future IDE versions</li>
    </ul>
    <h3>1.0.1</h3>
    <ul>
        <li>Extend compatibility to PhpStorm 2025.4</li>
        <li>Add publishPlugin configuration</li>
    </ul>
    <h3>1.0.0</h3>
    <ul>
        <li>Initial release</li>
        <li>One-click commit message generation using Claude AI</li>
        <li>Conventional Commits format</li>
        <li>Model selection (Sonnet, Haiku, Opus)</li>
        <li>Multi-language support (English, Russian)</li>
        <li>Custom prompt support</li>
        <li>API key stored securely via PasswordSafe</li>
    </ul>
    ]]></change-notes>

    <depends>com.intellij.modules.platform</depends>
    <depends>Git4Idea</depends>

    <extensions defaultExtensionNs="com.intellij">
        <applicationConfigurable
                parentId="tools"
                instance="com.aicommitmessage.settings.AppSettingsConfigurable"
                id="com.aicommitmessage.settings.AppSettingsConfigurable"
                displayName="AI Commit Message"/>
        <applicationService
                serviceImplementation="com.aicommitmessage.settings.AppSettings"/>
    </extensions>

    <actions>
        <action id="AICommitMessage.Generate"
                class="com.aicommitmessage.action.GenerateCommitMessageAction"
                text="Generate Commit Message"
                description="Generate commit message using Claude AI"
                icon="AllIcons.Actions.Lightning">
            <add-to-group group-id="Vcs.MessageActionGroup" anchor="first"/>
        </action>
    </actions>
</idea-plugin>
